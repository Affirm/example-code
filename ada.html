<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <title>Affirm ADA Demo</title>
    <script>
        // Begin Affirm JS embed code
        // =======================
        _affirm_config = {
            script:"https://cherry-ave-sandbox.affirm-odin.com/js/v2/affirm.js",
            public_api_key:"PreSeededApiKeyDirect"
        };
        (function(l,g,m,e,a,f,b){var d,c=l[m]||{},h=document.createElement(f),n=document.getElementsByTagName(f)[0],k=function(a,b,c){return function(){a[b]._.push([c,arguments])}};c[e]=k(c,e,"set");d=c[e];c[a]={};c[a]._=[];d._=[];c[a][b]=k(c,a,b);a=0;for(b="set add save post open empty reset on off trigger ready setProduct".split(" ");a<b.length;a++)d[b[a]]=k(c,e,b[a]);a=0;for(b=["get","token","url","items"];a<b.length;a++)d[b[a]]=function(){};h.async=!0;h.src=g[f];n.parentNode.insertBefore(h,n);delete g[f];d(g);l[m]=c})(window,_affirm_config,"affirm","checkout","ui","script","ready");
        // =======================
        // End Affirm JS embed code
    </script>
    <style>
        html {
            font-family: sans-serif;
            text-align: center;
        }
        h4 {
            text-decoration: underline;
        }
        #container {
            margin: 0 auto;
            width:600px;
            border-radius:5px;
            box-shadow: 0px 5px 10px 1px rgba(0,0,0,.2);
            padding:2em;
        }
        #checkout_button {
            border:0px solid #000;
            background:url("https://cdn-assets.affirm.com/images/buttons/checkout/42x205-white.png");
            width:205px;
            height:42px;
            line-height:42px;
            text-align: center;
            cursor:pointer;
        }
    </style>
</head>
<body>
<h1>Affirm ADA Demo</h1>
<div id="container">
    <!-- <h4>"as low as":</h4>
    <div class="affirm-as-low-as" data-amount="30000" data-promo-id="promo_set_oala">Placeholder</div>
    <br/> -->
    <h4>Affirm checkout:</h4>
    <button aria-label="checkout with affirm" id="checkout_button">&nbsp</button>
</div>
<script>
// Checkout
// -----------------------
// Checkout button

document.getElementById("checkout_button").addEventListener("click",initiateCheckout);
document.body.onkeypress=function(e){
    if(e.keyCode==13){
        initiateCheckout();
    }
};

var currentLocation = location.href;

function initiateCheckout() {
    
    checkout_object = {
        "merchant": {
            "name": "Affirm ADA Demo",
            "user_cancel_url": "http://requestbin.fullcontact.com/tgwcwhtg",
            "user_confirmation_url": "http://requestbin.fullcontact.com/tgwcwhtg"
        },
        "metadata":{
            "mode":"modal"
        },
        "shipping": {
            "name": {
                "first":"Joe",
                "last": "Doe"
            },
            "address": {
                "line1": "650 California St.",
                "line2": "Floor 12",
                "city": "San Francisco",
                "state": "CA",
                "zipcode": "94108"
            },
            "phone_number": "4153334452",
            "email": "joe.doe@123fakestreet.com"
        },
        "billing": {
            "name": {
                "first":"Joe",
                "last": "Doe"
            },
            "address": {
                "line1": "650 California St.",
                "line2": "Floor 12",
                "city": "San Francisco",
                "state": "CA",
                "zipcode": "94108"
            },
            "phone_number": "4153334452",
            "email": "joe.doe@123fakestreet.com"
        },
        "items": [
            {
                "display_name":"Name of item",
                "sku":"123",
                "unit_price":19999,
                "qty": 1,
                "item_image_url":"http://www.walmart.com",
                "item_url":"http://www.walmart.com"
            }
        ],
        "shipping_amount":499,
        "tax_amount": 30000,
        "total": 30000
    };
    affirm.checkout(checkout_object);
    affirm.checkout.open(
        {
        onSuccess:function(a){
            console.log(a);
        },
        onFail:function(a){console.log(a)} 
        }
    );
    setTimeout(function() {
        if (document.getElementById("checkout-application")) {
          var url = document.getElementById("checkout-application").src;    
          if (url.indexOf('?') > -1){
           url += '&enableAda=1';
          } else{
           url += '?enableAda=1';
          }
          document.getElementById("checkout-application").src = url;
        }
    }, 3000);
}
</script>

</body>
</html>
