<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<title>Affirm Checkout</title>
	<script>
	    // Begin Affirm JS embed code
		// =======================
		_affirm_config = {
		    script:"https://cdn1-sandbox.affirm.com/js/v2/affirm.js",
		    public_api_key:"ARQBLCL7NAMBTZ7F"
		};
		(function(l,g,m,e,a,f,b){var d,c=l[m]||{},h=document.createElement(f),n=document.getElementsByTagName(f)[0],k=function(a,b,c){return function(){a[b]._.push([c,arguments])}};c[e]=k(c,e,"set");d=c[e];c[a]={};c[a]._=[];d._=[];c[a][b]=k(c,a,b);a=0;for(b="set add save post open empty reset on off trigger ready setProduct".split(" ");a<b.length;a++)d[b[a]]=k(c,e,b[a]);a=0;for(b=["get","token","url","items"];a<b.length;a++)d[b[a]]=function(){};h.async=!0;h.src=g[f];n.parentNode.insertBefore(h,n);delete g[f];d(g);l[m]=c})(window,_affirm_config,"affirm","checkout","ui","script","ready");
		// =======================
		// End Affirm JS embed code
	</script>
	<style>
		body {
			font-family: "Helvetica";
		}
		#merchant_checkout {
			margin:100px;
			padding:100px;
			border:10px solid #ddd;
			background:#eee; 
			vertical-align: top;
			line-height:300px;
			height:300px;
			text-align: center;
		}
	</style>
</head>
<body>

<script>

// Checkout
// -----------------------
// Checkout button

document.body.onkeypress=function(e){
	if(e.keyCode==13){
		initiateCheckout();
	}
};

var currentLocation = location.href;

function initiateCheckout () {
	
	checkout_object = {
		"merchant": {
			"name": "Affirm Example Code",
			"user_cancel_url": currentLocation,
			"user_confirmation_url": currentLocation,
			// User is sent to this URL if they voluntarily cancel/close checkout, or are denied
		},
		"metadata":{
			"mode":"modal"
		},
		"shipping": {
			"name": {
				"first":"Joe",
				"last": "Doe"
			},
			"address": {
				"line1": "633 Folsom St.",
				"line2": "Floor 7",
				"city": "San Francisco",
				"state": "CA",
				"zipcode": "94107"
			},
			"phone_number": "4153334452",
			"email": "joe.doe@123fakestreet.com"
		},
		"billing": {
			"name": {
				"first":"Joe",
				"last": "Doe"
			},
			"address": {
				"line1": "633 Folsom St.",
				"line2": "Floor 7",
				"city": "San Francisco",
				"state": "CA",
				"zipcode": "94107"
			},
			"phone_number": "4153334452",
			"email": "joe.doe@123fakestreet.com"
		},
		"items": [
			{
				"display_name":"Name of item",
				"sku":"123",
				"unit_price":19999,
				"qty": 1,
				"item_image_url":"http://www.google.com",
				"item_url":"http://www.google.com"
			}
		],
		"shipping_amount":499,
		"taxAmount": 0,
		"total": 0,
		// "checkout_expiration": expire_time()
	};
	affirm.checkout(checkout_object);
	affirm.checkout.open(
		{
		onSuccess:function(a){console.log(a)},
		onFail:function(a){console.log(a)}
		}
	);
}
console.log('hi!');
</script>

<div id="merchant_checkout">
	Merchant Checkout Flow
</div>

<script type="text/javascript">
	setTimeout(function(){ console.log("Hello"); }, 10000);
</script>

</body>
</html>