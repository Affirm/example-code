<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<title>Prequal Test - Prod Sandbox</title>
	<link rel="stylesheet" href="./assets/default.css">
	<script>
		var qd = {};
		if (location.search) {
			var qs = location.search.substr(1).split("&");
			for (var i = qs.length - 1; i >= 0; i--) {
					var s = qs[i].split("="), 
					k = s[0], 
					v = s[1] && decodeURIComponent(s[1]); 
					qd[k] = v;
			}		
		}
		var env = qd.env;
		var _affirm_config = {};
		var _title = "Prequal Test";
		var _heading = "Prequal Test";
		switch(env){
			case 'sandbox':
				_affirm_config = {
					script:"https://cdn1-sandbox.affirm.com/js/v2/affirm.js",
					public_api_key:"ARQBLCL7NAMBTZ7F"
				};
				_title = "Prequal Test - Prod Sandbox";
				_heading = "Prequal Test - Prod Sandbox";
				break;
			case 'live':
				_affirm_config = {
					script:"https://cdn1.affirm.com/js/v2/affirm.js",
					public_api_key:"5GDPSC5HC4Y7Y9TX"
				};
				_title = "Prequal Test - Prod Live";
				_heading = "Prequal Test - Prod Live";
				break;
			case 'stagelive':
				_affirm_config = {
					script:"https://cdn1.affirm-stage.com/js/v2/affirm.js",
					public_api_key:"TOPYWMTUK7GVMNED" 
				};
				_title = "Prequal Test - Stage Live";
				_heading = "Prequal Test - Stage Live";
				break;
			case 'special2':
				_affirm_config = {
					script:"https://special-2.affirm-dev.com/js/v2/affirm.js",
					public_api_key:"QAZKCCUVPDTP7RE2" 
				};
				_title = "Prequal Test - Dev Special-2";
				_heading = "Prequal Test - Dev Special-2";
				break;			
			case 'int14':
				_affirm_config = {
					script:"https://int-1-4.affirm-stage.com/js/v2/affirm.js",
					public_api_key:"FND06LW8187URGAA" 
				};
				_title = "Prequal Test - Stage Int-1-4";
				_heading = "Prequal Test - Stage Int-1-4";
				break;
			default:
				_affirm_config = {
					script:"https://cdn1-sandbox.affirm-stage.com/js/v2/affirm.js",
					public_api_key:"C2S4ECO7NTD9T5GO" 
				};
				_title = "Prequal Test - Stage Sandbox";
				_heading = "Prequal Test - Stage Sandbox";
				break;
		}
		// Begin Affirm JS embed code
		// =======================
		(function(l,g,m,e,a,f,b){var d,c=l[m]||{},h=document.createElement(f),n=document.getElementsByTagName(f)[0],k=function(a,b,c){return function(){a[b]._.push([c,arguments])}};c[e]=k(c,e,"set");d=c[e];c[a]={};c[a]._=[];d._=[];c[a][b]=k(c,a,b);a=0;for(b="set add save post open empty reset on off trigger ready setProduct".split(" ");a<b.length;a++)d[b[a]]=k(c,e,b[a]);a=0;for(b=["get","token","url","items"];a<b.length;a++)d[b[a]]=function(){};h.async=!0;h.src=g[f];n.parentNode.insertBefore(h,n);delete g[f];d(g);l[m]=c})(window,_affirm_config,"affirm","checkout","ui","script","ready");
		// =======================
		// End Affirm JS embed code

	</script>
</head>
<body>
	<h1 id="heading">Prequal Test - Prod Sandbox</h1>
	Environment select:
	<ul>
		<li><a href="./prequal.html?env=live">Prod Live</a></li>
		<li><a href="./prequal.html?env=sandbox">Prod Sandbox</a></li><br/>
		<li><a href="./prequal.html?env=stagelive">Stage Live</a></li>
		<li><a href="./prequal.html?env=stagesandbox">Stage Sandbox</a></li>
		<li><a href="./prequal.html?env=int14">Stage Int-1-4</a></li><br/>
		<li><a href="./prequal.html?env=special2">Dev Special-2</a></li>
	</ul>
	<div class="column">
		<h2>Config</h2>
		<div>
			<h4>Merchant</h4>
			<table>
				<tr>
					<td>Display Name</td>
					<td><input type="text" value="Example Merchant Name" id="merchantName"></td>
				</tr>
			</table>
		</div>
			<div>
			<h4>Prequal</h4>
			<table>
				<tr>
					<td>Page Type</td>
					<td><input type="text" value="home" id="pageType"></td>
				</tr>
			</table>
		</div>
		<div>
			<h4>Items</h4>
			<table>
				<tr>
					<td>Display Name</td>
					<td><input type="text" value="Example Product Name" id="itemName"></td>
				</tr>
				<tr>
					<td>URL</td>
					<td><input type="text" value="https://www.merchantname.com/best_product_ever" id="itemUrl"></td>
				</tr>
				<tr>
					<td>Quantity</td>
					<td><input type="number" value="1" id="itemQuantity"></td>
				</tr>
				<tr>
					<td>Unit Price</td>
					<td><input type="number" value="400000" id="itemPrice"></td>
				</tr>
				<tr>
					<td>SKU</td>
					<td><input type="text" value="ABC-123" id="itemSku"></td>
				</tr>
			</table>
		</div>
	</div>
	<div class="column">
		<h2>Functionality</h2>
		<input type="button" class="button3" id="setPrequal" value="Set Prequal Widget">
		<input type="button" class="button1" id="showPrequal" value="Show Prequal Widget">
		<input type="button" class="button2" id="launchPrequal" value="Launch Prequal Flow">
	</div>
	<script>
		document.title = _title;;
		document.getElementById('heading').innerText = _heading;
	</script>
	<script type="text/javascript">
		var launchPrequalButton = document.getElementById('launchPrequal'),
		showPrequalButton = document.getElementById('showPrequal'),
		setPrequalButton = document.getElementById('setPrequal');
		setPrequalButton.addEventListener('click', setPrequal, false);
		showPrequalButton.addEventListener('click', showPrequal, false);
		launchPrequalButton.addEventListener('click', launchPrequal, false);
		function showPrequal() {
			affirm.ui.prequal.show();
		}
		function launchPrequal() {
			affirm.ui.prequal.launchPrequalFlow();
		}
		function setPrequal() {
			// Grab form values
			var merchantName = document.getElementById('merchantName').value,
			pageType = document.getElementById('pageType').value,
			itemName = document.getElementById('itemName').value,
			itemUrl = document.getElementById('itemUrl').value,
			itemQuantity = document.getElementById('itemQuantity').value,
			itemPrice = document.getElementById('itemPrice').value,
			itemSku = document.getElementById('itemSku').value

		    var a = {
		    	"merchant_name": merchantName,
    			"page_type": pageType,
    			"item": [{
	        		"display_name": itemName,
	        	    "item_url": itemUrl,
	            	"sku": itemSku,
	            	"unit_price": itemPrice,
	            	"qty": itemQuantity
        		}]
    		}
    		affirm.prequal.set(a);
    		setPrequalButton.classList.toggle('working');
			setPrequalButton.value = "Prequal Object Set!";
			setTimeout(function() {
				setPrequalButton.value = "Set Prequal Object";
				setPrequalButton.classList.toggle('working');
			}, 1500);
		}
	</script>
</body>
</html>